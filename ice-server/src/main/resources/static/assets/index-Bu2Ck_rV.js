import{r as i,I as y,_ as F,u as I,j as e,R as L}from"./index-CvRNfTkI.js";import{F as t,u as p,B as M,M as E,I as u,a as m,s as k}from"./useRequest-CDh3TdsD.js";var R={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M904 512h-56c-4.4 0-8 3.6-8 8v320H184V184h320c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V520c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M355.9 534.9L354 653.8c-.1 8.9 7.1 16.2 16 16.2h.4l118-2.9c2-.1 4-.9 5.4-2.3l415.9-415c3.1-3.1 3.1-8.2 0-11.3L785.4 114.3c-1.6-1.6-3.6-2.3-5.7-2.3s-4.1.8-5.7 2.3l-415.8 415a8.3 8.3 0 00-2.3 5.6zm63.5 23.6L779.7 199l45.2 45.1-360.5 359.7-45.7 1.1.7-46.4z"}}]},name:"form",theme:"outlined"},w=function(n,a){return i.createElement(y,F({},n,{ref:a,icon:R}))},C=i.forwardRef(w);const b=()=>{const c=I(),[n]=t.useForm(),[a,o]=i.useState({type:1,open:!1,name:"",info:"",id:0}),{data:r,run:f}=p(m.appList),{run:l,loading:x}=p(m.appEdit,{manual:!0,onSuccess:()=>{f(),d(),k.success("操作成功")}});i.useEffect(()=>{a.open&&n.setFieldsValue({name:a.name,info:a.info})},[a,n]);const d=()=>{o({type:1,open:!1,name:"",info:"",id:0}),n.resetFields()},h=async()=>{try{const s=await n.validateFields();a.type===2?await l({...s,id:a.id}):await l(s)}catch(s){console.error("Form validation failed:",s)}},j=s=>{c(`/config/list?app=${s}`)},v=(r==null?void 0:r.list)||[];return e.jsxs("div",{children:[e.jsx(M,{type:"primary",icon:e.jsx(L,{}),onClick:()=>o({type:1,open:!0,name:"",info:"",id:0}),style:{padding:"12px 12px",top:"6px",left:"12px"},children:"新增"}),e.jsx("div",{className:"app-list",children:v.map(s=>e.jsxs("div",{className:"app-item",onClick:()=>{j(s.id)},children:[e.jsx("div",{className:"app-edit",children:e.jsx(C,{onClick:g=>{g.stopPropagation(),o({type:2,open:!0,name:s.name,info:s.info,id:s.id})}})}),e.jsx("p",{children:s.name}),e.jsxs("p",{children:["app: ",s.id," "]}),e.jsx("p",{children:s.info})]},s.id))}),e.jsx(E,{title:a.type===1?"新增":"编辑",open:a.open,onOk:h,onCancel:d,okText:"确认",cancelText:"取消",confirmLoading:x,children:e.jsxs(t,{form:n,children:[e.jsx(t.Item,{label:"名称",name:"name",rules:[{required:!0,message:"请输入名称"}],children:e.jsx(u,{})}),e.jsx(t.Item,{label:"描述",name:"info",rules:[{required:!0,message:"请输入描述"}],children:e.jsx(u,{})})]})})]})};export{b as default};
